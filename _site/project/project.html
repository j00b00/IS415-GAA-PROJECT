<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-04-14">

<title>IS415-GAA-Project - Project: CrimeWatch Vietnam Law and Order Geosptial Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">IS415-GAA-Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../project/project.html" rel="" target="" aria-current="page">
 <span class="menu-text">Project</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#theme-geographic-segmentation" id="toc-theme-geographic-segmentation" class="nav-link active" data-scroll-target="#theme-geographic-segmentation">THEME: GEOGRAPHIC SEGMENTATION</a></li>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">1 ABSTRACT</a></li>
  <li><a href="#problem-motivation" id="toc-problem-motivation" class="nav-link" data-scroll-target="#problem-motivation">2 Problem &amp; Motivation</a></li>
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link" data-scroll-target="#project-objectives">3 Project Objectives</a></li>
  <li><a href="#data-sets-and-descriptions" id="toc-data-sets-and-descriptions" class="nav-link" data-scroll-target="#data-sets-and-descriptions">4 Data Sets and Descriptions</a></li>
  <li><a href="#data-preparation-and-diagram-flow" id="toc-data-preparation-and-diagram-flow" class="nav-link" data-scroll-target="#data-preparation-and-diagram-flow">5 Data Preparation and Diagram flow</a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review">6 Literature Review</a>
  <ul class="collapse">
  <li><a href="#title-delineating-social-area-analysis-using-geographic-segmentation-approach" id="toc-title-delineating-social-area-analysis-using-geographic-segmentation-approach" class="nav-link" data-scroll-target="#title-delineating-social-area-analysis-using-geographic-segmentation-approach"><strong>Title: Delineating Social Area Analysis using Geographic Segmentation Approach</strong></a></li>
  <li><a href="#title-an-r-package-for-hierarchical-clustering-with-spatial-constraints" id="toc-title-an-r-package-for-hierarchical-clustering-with-spatial-constraints" class="nav-link" data-scroll-target="#title-an-r-package-for-hierarchical-clustering-with-spatial-constraints"><strong>Title: An R package for hierarchical clustering with spatial constraints</strong></a></li>
  <li><a href="#title-cluster-analysis-and-segmentation" id="toc-title-cluster-analysis-and-segmentation" class="nav-link" data-scroll-target="#title-cluster-analysis-and-segmentation"><strong>Title: Cluster Analysis and Segmentation</strong></a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">7 Methodology</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">7.1 Data Preparation</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">7.2 Exploratory Data Analysis</a></li>
  <li><a href="#exploratory-spatial-data-analysis" id="toc-exploratory-spatial-data-analysis" class="nav-link" data-scroll-target="#exploratory-spatial-data-analysis">7.3 Exploratory Spatial Data Analysis</a></li>
  <li><a href="#geographical-segmentation-with-spatially-constrained-cluster-analysis" id="toc-geographical-segmentation-with-spatially-constrained-cluster-analysis" class="nav-link" data-scroll-target="#geographical-segmentation-with-spatially-constrained-cluster-analysis">7.4 Geographical Segmentation with Spatially Constrained Cluster Analysis</a></li>
  </ul></li>
  <li><a href="#storyboard" id="toc-storyboard" class="nav-link" data-scroll-target="#storyboard">8 Storyboard</a>
  <ul class="collapse">
  <li><a href="#initial-prototype" id="toc-initial-prototype" class="nav-link" data-scroll-target="#initial-prototype">8.1 Initial Prototype</a></li>
  <li><a href="#finalise-prototype" id="toc-finalise-prototype" class="nav-link" data-scroll-target="#finalise-prototype">8.2 Finalise Prototype</a>
  <ul class="collapse">
  <li><a href="#eda-page-histogram" id="toc-eda-page-histogram" class="nav-link" data-scroll-target="#eda-page-histogram">8.2.1 EDA Page Histogram</a></li>
  <li><a href="#eda-page-box-plot" id="toc-eda-page-box-plot" class="nav-link" data-scroll-target="#eda-page-box-plot">8.2.2 EDA Page Box Plot</a></li>
  <li><a href="#esda" id="toc-esda" class="nav-link" data-scroll-target="#esda">8.2.3 ESDA</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">8.2.4 Clustering</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#application-architecture" id="toc-application-architecture" class="nav-link" data-scroll-target="#application-architecture">9 Application architecture</a></li>
  <li><a href="#project-timeline" id="toc-project-timeline" class="nav-link" data-scroll-target="#project-timeline">10 Project timeline</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project: CrimeWatch Vietnam Law and Order Geosptial Analysis</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 14, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="theme-geographic-segmentation" class="level1">
<h1>THEME: GEOGRAPHIC SEGMENTATION</h1>
</section>
<section id="abstract" class="level1">
<h1>1 ABSTRACT</h1>
<p>This project involves 3 main segments, mainly, conducting Exploratory Spatial Data Analysis, Geographical Segmentation with Spatially Constrained Clustering Techniques, and Local Indicators of Spatial association techniques using the Provincial Competitiveness Index of Vietnam. Specifically, we will analyze the “law and order” dataset to reveal preliminary findings, segment the various provinces in Vietnam as well as identify cold and hotspots amongst the province of Vietnam. The goal of the project is to create a web application that aims to aid users in performing exploratory data analysis, hierarchy cluster analysis, spatially constrained clustering, spatially contained clustering, and cold/hotspot analysis. The web application users can effortlessly analyze the data by adjusting variable inputs without needing any technical knowledge or expertise in data wrangling, allowing them to make useful insights from their findings</p>
</section>
<section id="problem-motivation" class="level1">
<h1>2 Problem &amp; Motivation</h1>
<p>The legal system of Vietnam is based on the socialism legal theory and inherited from French civil law system. However, data shows that the enforcement of these laws and regulations can differ depending on the province. This sparked our interest to investigate the reason behind this phenomenon by using clustering methods to visualise patterns within the provinces.</p>
<p>Geospatial analytics in R allows us to manipulate and analyse data visually so that we can uncover patterns that may otherwise go unnoticed. However, geospatial analytics requires users to be experienced and seasoned in finding data on the internet and it can be tedious to wrangle with the data to the right format for processing. This interactive web application allows users to carry out analysis simply through interacting with the user interface so that even business users can operate. By providing an interactive consolidated platform for users to view data and corresponding analyses, we make the data easily accessible while still allowing for customization through the user interface. Exploratory Spatial Data Analysis, we can investigate the dataset and summarize their main characteristics. It aims to provide us a sense of how “good” or “bad” our dataset is, allowing us to make more logical conclusions based on the findings.</p>
<p>The Clustering technique is crucial to allow us to realize how similar or dissimilar a group or a point of data is compared to others. This important information can allow users to do audience segmentation. Lastly, the cold/hotspot analysis helps to reinforce the findings of the clustering analysis and helps user to better visualize these clusters based on their densities.</p>
</section>
<section id="project-objectives" class="level1">
<h1>3 Project Objectives</h1>
<ol type="1">
<li><p>Interactive user interface design</p></li>
<li><p>Conduct exploratory data analysis using correlation analysis, histograms, boxplots, and box maps for preliminary analysis.</p></li>
<li><p>Conduct hierarchy cluster analysis using the SKATER approach, Hierarchical Clustering, and ClustGeo method.</p></li>
<li><p>Conduct LISA cold/hotspot analysis using Moran’s I method.</p></li>
</ol>
</section>
<section id="data-sets-and-descriptions" class="level1">
<h1>4 Data Sets and Descriptions</h1>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 2%">
<col style="width: 56%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Data</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description…Remarks</th>
<th style="text-align: left;">Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vietnam Subnational Administrative Boundary</td>
<td style="text-align: left;">.shp</td>
<td style="text-align: left;">The administrative boundary consists of 3 levels. 0- country level, 1- Province level, 2- district.</td>
<td style="text-align: left;">https://data.humdata.org/dataset/cod-ab-vnm?</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam PCI indicator</td>
<td style="text-align: left;">.csv</td>
<td style="text-align: left;">PCI indicator consists of different factors that help gauge the performance of provinces. The site offers yearly PCI data.</td>
<td style="text-align: left;">https://pcivietnam.vn/en/pci-data</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="data-preparation-and-diagram-flow" class="level1">
<h1>5 Data Preparation and Diagram flow</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/data_preparation_and_diagram_flow.png" class="img-fluid" width="345"></p>
</div>
</div>
</section>
<section id="literature-review" class="level1">
<h1>6 Literature Review</h1>
<section id="title-delineating-social-area-analysis-using-geographic-segmentation-approach" class="level2">
<h2 class="anchored" data-anchor-id="title-delineating-social-area-analysis-using-geographic-segmentation-approach"><strong>Title: Delineating Social Area Analysis using Geographic Segmentation Approach</strong></h2>
<p><strong>Source:</strong> <a href="https://rpubs.com/YuMengTing/618944" class="uri">https://rpubs.com/YuMengTing/618944</a></p>
<p><strong>Summary:</strong> Social area analysis (SAA), which is a generic name for a number of methods employing census and other data to classify small areas into similar socioeconomic groups, is an approach which quantifies data in a useful fashion and has important applications in regional development, urban planning, medical and health services research. The potentialities of the approach for Liveable City planning and Smart City preparedness, however, have yet to be explored.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/fig_1.jpg" class="img-fluid"></p>
</div>
</div>
<p><strong>Learning points:</strong> The initial stages of data preparation have to be done very meticulously as we want to avoid misrepresentation. For skater analysis, when plotting spatially constrained clusters (Figure 1), it will be better to accompany it with a choropleth map to aid visualization of clusters.</p>
</section>
<section id="title-an-r-package-for-hierarchical-clustering-with-spatial-constraints" class="level2">
<h2 class="anchored" data-anchor-id="title-an-r-package-for-hierarchical-clustering-with-spatial-constraints"><strong>Title: An R package for hierarchical clustering with spatial constraints</strong></h2>
<p><strong>Source</strong>: <a href="https://arxiv.org/pdf/1707.03897.pdf" class="uri">https://arxiv.org/pdf/1707.03897.pdf</a></p>
<p><strong>Summary:</strong> In this paper, the authors propose a ward-like hierarchical clustering algorithm including spatial constraints. The dissimilarities can be non-euclidean and the weights of the observations can be non uniform.</p>
<p><strong>Learning points:</strong> When trying to carry out Hierarchical clustering, we need to have a dissimilarity matrix D of class dist. It is important for us to alter or transform our matrix to an appropriate data type for the function to work properly. The highlight of the paper is the calculation and algorithms used to do clustering.</p>
</section>
<section id="title-cluster-analysis-and-segmentation" class="level2">
<h2 class="anchored" data-anchor-id="title-cluster-analysis-and-segmentation"><strong>Title: Cluster Analysis and Segmentation</strong></h2>
<p><strong>Source:</strong> <a href="https://inseaddataanalytics.github.io/INSEADAnalytics/CourseSessions/Sessions45/ClusterAnalysisReading.html#step_8:_robustness_analysis" class="uri">https://inseaddataanalytics.github.io/INSEADAnalytics/</a></p>
<p><a href="https://inseaddataanalytics.github.io/INSEADAnalytics/CourseSessions/Sessions45/ClusterAnalysisReading.html#step_8:_robustness_analysis" class="uri">CourseSessions/Sessions45/ClusterAnalysisReading.html#step_8:_robustness_analysis</a></p>
<p><strong>Summary:</strong> In Data Analytics we often have very large data (many observations - “rows in a flat file”), which are however similar to each other hence we may want to organize them in a few clusters with similar observations within each cluster. For example, in the case of customer data, even though we may have data from millions of customers, these customers may only belong to a few segments: customers are similar within each segment but different across segments. We may often want to analyze each segment separately, as they may behave differently.</p>
<p><strong>Learning points:</strong> Much like any data analysis, segmentation is an iterative process with many variations of data, methods, number of clusters, and profiles generated until a satisfying solution is reached. The paper discusses examples on how to test the statistical robustness and stability of interpretation of clusters found using 2 different approaches.</p>
</section>
</section>
<section id="methodology" class="level1">
<h1>7 Methodology</h1>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">7.1 Data Preparation</h2>
<ul>
<li><p>Data sources from online platforms</p></li>
<li><p>Importing spatial data into the R environment</p></li>
<li><p>Data wrangling</p></li>
</ul>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">7.2 Exploratory Data Analysis</h2>
<ul>
<li><p>Plotting up graphs for visualization and better understanding of the data</p>
<ul>
<li><p>Histogram - Visualize the distribution of data by bins each representing a range of data values</p></li>
<li><p>Percentile Map - A quantile map to visualize the distribution of data on a map</p></li>
<li><p>Box-plot - Visualize the distribution of data by graphically depicting groups of data through their quartiles</p></li>
<li><p>Box Map - An augmented quantile map with an additional lower and upper category to visualize the distribution of the data on a map</p></li>
</ul></li>
</ul>
</section>
<section id="exploratory-spatial-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-spatial-data-analysis">7.3 Exploratory Spatial Data Analysis</h2>
<ul>
<li><p>Visualize spatial data and examine the spatial distribution of data points</p>
<ul>
<li>LISA - Identify spatial clusters or patterns of similarity and dissimilarity</li>
</ul></li>
</ul>
</section>
<section id="geographical-segmentation-with-spatially-constrained-cluster-analysis" class="level2">
<h2 class="anchored" data-anchor-id="geographical-segmentation-with-spatially-constrained-cluster-analysis">7.4 Geographical Segmentation with Spatially Constrained Cluster Analysis</h2>
<ul>
<li><p>Divide a target market by location to allow marketers to better serve customers in a particular area</p>
<ul>
<li><p>Hierarchy Cluster Analysis - Classify objects into clusters based on similarity or dissimilarity.</p></li>
<li><p>Spatially Constrained Clustering: SKATER approach - Uses spatial proximity to identify spatial patterns</p></li>
<li><p>Spatially Constrained Clustering: CLUSTGEO method - Partition spatial data into cluster base on attribute similarity and spatial contiguity.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="storyboard" class="level1">
<h1>8 Storyboard</h1>
<p>In this section, we delve into the intricate process of ideation and its indispensable companion, initial prototyping. Here, we recognize the paramount importance of prototyping as the bridge between conception and realization, the tool through which ideas are refined, tested, and ultimately perfected. Join us as we navigate through the meticulous craft of ideation, and witness firsthand the transformative power of prototyping in bringing visionary concepts to fruition.We look into the depths of our project to determine what sort of design we’ll strive towards.</p>
<section id="initial-prototype" class="level3">
<h3 class="anchored" data-anchor-id="initial-prototype">8.1 Initial Prototype</h3>
<p>8.1.1 EDA Histogram</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/histogram.png" class="img-fluid" width="402"></p>
</div>
</div>
<p>8.1.2 EDA Box Plot</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/boxplot.png" class="img-fluid" width="414"></p>
</div>
</div>
<p>8.1.3 Hierarchical Clustering</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/HCA_ChoroplethMap.png" class="img-fluid" width="416"></p>
</div>
<div class="cell-output-display">
<p><img src="img/dendogram.png" class="img-fluid" width="417"></p>
</div>
</div>
<p>8.1.4 SKATER</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/SKATER.jpg" class="img-fluid"></p>
</div>
</div>
<p>8.1.5 ClustGeo</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/ClustGeo.png" class="img-fluid" width="998"></p>
</div>
<div class="cell-output-display">
<p><img src="img/clustgeo2.png" class="img-fluid" width="994"></p>
</div>
</div>
</section>
<section id="finalise-prototype" class="level2">
<h2 class="anchored" data-anchor-id="finalise-prototype">8.2 Finalise Prototype</h2>
<section id="eda-page-histogram" class="level3">
<h3 class="anchored" data-anchor-id="eda-page-histogram">8.2.1 EDA Page Histogram</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/histogram.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="eda-page-box-plot" class="level3">
<h3 class="anchored" data-anchor-id="eda-page-box-plot">8.2.2 EDA Page Box Plot</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/boxplot.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="esda" class="level3">
<h3 class="anchored" data-anchor-id="esda">8.2.3 ESDA</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/ESDA.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="clustering" class="level3">
<h3 class="anchored" data-anchor-id="clustering">8.2.4 Clustering</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/clustering.jpg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="application-architecture" class="level1">
<h1>9 Application architecture</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/application_architecture.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="project-timeline" class="level1">
<h1>10 Project timeline</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/project_timeline.jpg" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>